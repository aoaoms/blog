import{b as N,u as P,_ as V,w as K,d as T,E as $,a as A,c as D,e as W,f as z}from"./db-B-mUlyMr.js";import{b as S}from"./route-block-B_A1xBdJ.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{h as E,i as x,j as J,o as C,k as L,w as a,r as M,n as I,u as y,l as O,m as q,q as G,s as H,v as b,x as U,y as X,c as Y,d as f,a as s,e as r,z as Q,t as Z,F as ee,p as te,g as ae}from"./index-BmLE_wFg.js";const ne=Symbol("rowContextKey"),se=["start","center","end","space-around","space-between","space-evenly"],oe=["top","middle","bottom"],le=N({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:se,default:"start"},align:{type:String,values:oe}}),ie=E({name:"ElRow"}),ce=E({...ie,props:le,setup(g){const e=g,_=P("row"),o=x(()=>e.gutter);J(ne,{gutter:o});const d=x(()=>{const i={};return e.gutter&&(i.marginRight=i.marginLeft=`-${e.gutter/2}px`),i}),l=x(()=>[_.b(),_.is(`justify-${e.justify}`,e.justify!=="start"),_.is(`align-${e.align}`,!!e.align)]);return(i,v)=>(C(),L(q(i.tag),{class:I(y(l)),style:O(y(d))},{default:a(()=>[M(i.$slots,"default")]),_:3},8,["class","style"]))}});var re=V(ce,[["__file","row.vue"]]);const de=K(re),R=g=>(te("data-v-1c873e20"),g=g(),ae(),g),ue=R(()=>f("audio",{id:"idaudio",class:"invisible"},null,-1)),ge={class:"d-flex justify-content-center align-items-center",style:{height:"60px"}},pe={class:"d-flex justify-content-center align-items-center mb-3"},fe={class:"d-flex justify-content-center align-items-center w-100"},_e=R(()=>f("div",{class:"",style:{height:"120px"}},null,-1)),j={__name:"preview-mmpage",setup(g){const e=G({}),_=H("kit"),o=b(),d=b("originalContainer"),l=new Image;async function i(){return await T.page.toCollection().last()}const v=b(),k=async()=>{if(o.value&&(o.value.destroy(),o.value=null),l.src="",l.src=e.image.base64,l.src===""){$.alert("当前设计未包含图片，请重新设计");return}l.onload=function(){},setTimeout(()=>{let n=document.getElementById("idcanvas").offsetWidth,p=document.getElementById("idcanvas").offsetHeight,u=n/l.width;p/l.height,o.value=new Konva.Stage({container:"idcanvas",width:n,height:p,draggable:!1}),o.value.add(new Konva.Layer);const c=o.value.getLayers()[0],h=new Konva.Image({image:l,x:0,y:0,scaleX:u,scaleY:u,draggable:!1});c.add(h),o.value.draw(),e.content.forEach(t=>{const w=new Konva.Rect({x:t.boundingPolygon[0].x*u,y:t.boundingPolygon[0].y*u,width:parseFloat(t.width)*n/t.designWidth,height:parseFloat(t.height)*n/t.designWidth,fill:"transparent",stroke:"black",strokeWidth:1,draggable:!1});c.add(w),w.on("click",()=>{v.value=t.text+" "+t.translateText;const m=document.getElementById("idaudio");m.src=t.audio,m.play(),m.onended=()=>{t.translateAudio&&t.translateAudio.length>0&&new Audio(t.translateAudio).play()}})})},1e3)};U(()=>{i().then(n=>{e.content=JSON.parse(n.content),e.image=JSON.parse(n.image),e.coordinates=JSON.parse(n.coordinates)})}),X(d,(n,p)=>{k(),v.value="请点击框定的文本区域播放音频"});const B=()=>{_.downloadDesignPage(e)};return(n,p)=>{const u=A,c=D,h=W,t=z,w=de;return C(),Y(ee,null,[ue,f("div",ge,[s(u,{type:"primary",onClick:k,class:"me-5"},{default:a(()=>[r("加载页面")]),_:1}),s(h,{modelValue:y(d),"onUpdate:modelValue":p[0]||(p[0]=m=>Q(d)?d.value=m:null)},{default:a(()=>[s(c,{value:"originalContainer"},{default:a(()=>[r("设计时尺寸")]),_:1}),s(c,{value:"container23"},{default:a(()=>[r("宽高比2:3")]),_:1}),s(c,{value:"container34"},{default:a(()=>[r("宽高比3:4")]),_:1}),s(c,{value:"container58"},{default:a(()=>[r("宽高比5:8")]),_:1}),s(c,{value:"container57"},{default:a(()=>[r("宽高比5:7")]),_:1})]),_:1},8,["modelValue"])]),f("div",pe,[s(u,{type:"primary",onClick:B,class:"me-5"},{default:a(()=>[r("下载设计")]),_:1}),s(w,{class:"ms-3 d-inline-block text-center",style:{color:"#999","font-size":"14px"}},{default:a(()=>[s(t,{truncated:""},{default:a(()=>[r(Z(y(v)??"请点击框定的文本区域播放音频"),1)]),_:1})]),_:1})]),f("div",fe,[f("div",{id:"idcanvas",class:I(y(d))},null,2)]),_e],64)}}};typeof S=="function"&&S(j);const xe=F(j,[["__scopeId","data-v-1c873e20"]]);export{xe as default};
