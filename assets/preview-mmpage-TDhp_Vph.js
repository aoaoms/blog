import{b as N,u as P,_ as V,w as K,d as $,E as D,a as W,c as z,e as F,f as J}from"./db-BGzKqIn8.js";import{b as S}from"./route-block-B_A1xBdJ.js";import{h as E,i as x,j as T,o as C,k as L,w as t,r as M,n as I,u as m,l as O,m as q,_ as A,q as G,s as H,v as b,x as U,y as X,c as Y,d as f,a as n,e as r,z as Q,t as Z,F as ee,p as te,g as ae}from"./index-hMUs2JBo.js";const se=Symbol("rowContextKey"),ne=["start","center","end","space-around","space-between","space-evenly"],oe=["top","middle","bottom"],le=N({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:ne,default:"start"},align:{type:String,values:oe}}),ie=E({name:"ElRow"}),ce=E({...ie,props:le,setup(g){const e=g,_=P("row"),o=x(()=>e.gutter);T(se,{gutter:o});const d=x(()=>{const i={};return e.gutter&&(i.marginRight=i.marginLeft=`-${e.gutter/2}px`),i}),l=x(()=>[_.b(),_.is(`justify-${e.justify}`,e.justify!=="start"),_.is(`align-${e.align}`,!!e.align)]);return(i,y)=>(C(),L(q(i.tag),{class:I(m(l)),style:O(m(d))},{default:t(()=>[M(i.$slots,"default")]),_:3},8,["class","style"]))}});var re=V(ce,[["__file","row.vue"]]);const de=K(re),R=g=>(te("data-v-d477902a"),g=g(),ae(),g),ue=R(()=>f("audio",{id:"idaudio",class:"invisible"},null,-1)),ge={class:"d-flex justify-content-center align-items-center",style:{height:"60px"}},pe={class:"d-flex justify-content-center align-items-center mb-3"},fe={class:"d-flex justify-content-center align-items-center w-100"},_e=R(()=>f("div",{class:"",style:{height:"120px"}},null,-1)),j={__name:"preview-mmpage",setup(g){const e=G({}),_=H("kit"),o=b(),d=b("originalContainer"),l=new Image;async function i(){return await $.page.toCollection().last()}const y=b(),k=async()=>{if(o.value&&(o.value.destroy(),o.value=null),l.src="",l.src=e.image.base64,l.src===""){D.alert("当前设计未包含图片，请重新设计");return}l.onload=function(){},setTimeout(()=>{let a=document.getElementById("idcanvas").offsetWidth,p=document.getElementById("idcanvas").offsetHeight,u=a/l.width;p/l.height,o.value=new Konva.Stage({container:"idcanvas",width:a,height:p,draggable:!1}),o.value.add(new Konva.Layer);const c=o.value.getLayers()[0],h=new Konva.Image({image:l,x:0,y:0,scaleX:u,scaleY:u,draggable:!1});c.add(h),o.value.draw(),e.content.forEach(s=>{const v=new Konva.Rect({x:s.boundingPolygon[0].x*u,y:s.boundingPolygon[0].y*u,width:parseFloat(s.width)*a/s.designWidth,height:parseFloat(s.height)*a/s.designWidth,fill:"transparent",stroke:"black",strokeWidth:1,draggable:!1});c.add(v),v.on("click",()=>{y.value=s.text;const w=document.getElementById("idaudio");w.src=s.audio,w.play()})})},1e3)};U(()=>{i().then(a=>{e.content=JSON.parse(a.content),e.image=JSON.parse(a.image),e.coordinates=JSON.parse(a.coordinates)})}),X(d,(a,p)=>{k(),y.value="请点击框定的文本区域播放音频"});const B=()=>{_.downloadDesignPage(e)};return(a,p)=>{const u=W,c=z,h=F,s=J,v=de;return C(),Y(ee,null,[ue,f("div",ge,[n(u,{type:"primary",onClick:k,class:"me-5"},{default:t(()=>[r("加载页面")]),_:1}),n(h,{modelValue:m(d),"onUpdate:modelValue":p[0]||(p[0]=w=>Q(d)?d.value=w:null)},{default:t(()=>[n(c,{value:"originalContainer"},{default:t(()=>[r("设计时尺寸")]),_:1}),n(c,{value:"container23"},{default:t(()=>[r("宽高比2:3")]),_:1}),n(c,{value:"container34"},{default:t(()=>[r("宽高比3:4")]),_:1}),n(c,{value:"container58"},{default:t(()=>[r("宽高比5:8")]),_:1}),n(c,{value:"container57"},{default:t(()=>[r("宽高比5:7")]),_:1})]),_:1},8,["modelValue"])]),f("div",pe,[n(u,{type:"primary",onClick:B,class:"me-5"},{default:t(()=>[r("下载设计")]),_:1}),n(v,{class:"ms-3 d-inline-block text-center",style:{color:"#999","font-size":"14px"}},{default:t(()=>[n(s,{truncated:""},{default:t(()=>[r(Z(m(y)??"请点击框定的文本区域播放音频"),1)]),_:1})]),_:1})]),f("div",fe,[f("div",{id:"idcanvas",class:I(m(d))},null,2)]),_e],64)}}};typeof S=="function"&&S(j);const we=A(j,[["__scopeId","data-v-d477902a"]]);export{we as default};
